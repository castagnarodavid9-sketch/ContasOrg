<style>
  #parcela {
    display: none;
  }
</style>

<div class="page-wrapper">
  <div class="card shadow-sm rounded-3">
    <div class="card-header bg-white border-0">
      <h2 class="text-center mb-0">ðŸ’² Editando DÃ©bito (<%= @debito.nome_debito%>)</h2>
    </div>

    <div class="card-body">
      <%= form_with(model: debito, class: "row g-3") do |form| %>

        <% if debito.errors.any? %>
          <div class="col-12">
            <div class="alert alert-danger">
              <h5 class="mb-2">
                <%= pluralize(debito.errors.count, "error") %> impedem o salvamento:
              </h5>
              <ul class="mb-0">
                <% debito.errors.each do |error| %>
                  <li><%= error.full_message %></li>
                <% end %>
              </ul>
            </div>
          </div>
        <% end %>

        <!-- Nome -->
        <div class="col-md-6">
          <%= form.label :nome_debito, class: "form-label" %>
          <%= form.text_field :nome_debito,
                class: "form-control",
                placeholder: "Digite um nome",
                required: true %>
        </div>

        <!-- Valor -->
        <div class="col-md-6">
          <%= form.label :valor_debito, class: "form-label" %>
          <%= form.text_field :valor_debito,
                class: "form-control",
                placeholder: "Digite um valor",
                required: true %>
        </div>

        <!-- DescriÃ§Ã£o -->
        <div class="col-12">
          <%= form.label :descricao, class: "form-label" %>
          <%= form.text_area :descricao,
                class: "form-control",
                rows: 3,
                placeholder: "Informe uma descriÃ§Ã£o" %>
        </div>

        <!-- Data -->
        <div class="col-md-6">
          <%= form.label :data_vencimento, class: "form-label" %>
          <%= form.date_field :data_vencimento,
                class: "form-control",
                required: true %>
        </div>

        <!-- Parcelado -->
        <div class="col-md-6 d-flex align-items-end">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="toggleDiv">
            <label class="form-check-label" for="toggleDiv">
              Parcelado
            </label>
          </div>
        </div>

        <!-- Parcelas -->
        <div class="col-md-6 d-none" id="parcela">
          <%= label_tag :nro_vezes, "NÂ° de parcelas", class: "form-label" %>
          <%= number_field_tag :nro_vezes, nil,
                class: "form-control",
                placeholder: "Quantidade de parcelas" %>
        </div>

        <!-- Contrato -->
        <div class="col-12">
          <%= form.label "Contrato", class: "form-label" %>
          <%= form.collection_select :contrato_id,
                Contrato.all,
                :id,
                :nome_empresa,
                { prompt: "Selecione um contrato..." },
                class: "form-select" %>
        </div>

        <!-- BotÃ£o -->
        <div class="col-12 text-center">
          <%= form.submit "Criar dÃ©bito", class: "btn btn-primary px-4" %> |
          <%= link_to "Voltar", debitos_path, class: "btn btn-danger px-4" %>
        </div>

      <% end %>
    </div>
  </div>
</div>

<script>
$(document).ready(function () {
    console.log("PÃ¡gina carregada!");
    
    $("#toggleDiv").change(function () {
        if ($(this).is(":checked")) {
            $("#parcela").css("display", "block");
            $("#nro_vezes").prop("required", true);
        } else {
            $("#parcela").css("display", "none");
            $("#nro_vezes").prop("required", false);
        }
    });
});
</script>

